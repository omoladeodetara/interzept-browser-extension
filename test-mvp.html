<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interzept MVP Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background: #22d3ee;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0891b2;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow: auto;
        }
        .success { background: #d1fae5; color: #065f46; }
        .error { background: #fee2e2; color: #991b1b; }
    </style>
</head>
<body>
    <h1>üöÄ Interzept MVP Test Page</h1>
    <p>Use this page to test the Response Override functionality of your Interzept extension.</p>

    <div class="test-section">
        <h2>Test 1: JSONPlaceholder API Override</h2>
        <p>This will test overriding a real API endpoint.</p>
        <button onclick="testJSONPlaceholder()">Test JSONPlaceholder Override</button>
        <div id="result1" class="result"></div>
        
        <h3>Setup Instructions:</h3>
        <ol>
            <li>Open Interzept Options (right-click extension ‚Üí Options)</li>
            <li>Create a new Override rule with:
                <ul>
                    <li><strong>URL Pattern:</strong> <code>*://jsonplaceholder.typicode.com/posts/1*</code></li>
                    <li><strong>Response Body:</strong> <code>{"id": 1, "title": "MOCKED POST", "body": "This response was intercepted by Interzept!", "userId": 999}</code></li>
                    <li><strong>Status Code:</strong> 200</li>
                </ul>
            </li>
            <li>Save the rule and make sure it's enabled</li>
            <li>Click the test button above</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>Test 2: Custom API Override</h2>
        <p>This will test overriding a custom API endpoint.</p>
        <button onclick="testCustomAPI()">Test Custom API Override</button>
        <div id="result2" class="result"></div>
        
        <h3>Setup Instructions:</h3>
        <ol>
            <li>Create another Override rule with:
                <ul>
                    <li><strong>URL Pattern:</strong> <code>*://api.example.com/users*</code></li>
                    <li><strong>Response Body:</strong> <code>{"users": [{"id": 1, "name": "Mock User", "email": "mock@interzept.dev"}], "message": "Mocked by Interzept"}</code></li>
                    <li><strong>Status Code:</strong> 200</li>
                </ul>
            </li>
            <li>Save and enable the rule</li>
            <li>Click the test button above</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>Test 3: Error Response Override</h2>
        <p>This will test overriding with an error response.</p>
        <button onclick="testErrorResponse()">Test Error Override</button>
        <div id="result3" class="result"></div>
        
        <h3>Setup Instructions:</h3>
        <ol>
            <li>Create an Override rule with:
                <ul>
                    <li><strong>URL Pattern:</strong> <code>*://api.example.com/error*</code></li>
                    <li><strong>Response Body:</strong> <code>{"error": "Not Found", "message": "Resource was intercepted by Interzept", "code": 404}</code></li>
                    <li><strong>Status Code:</strong> 404</li>
                </ul>
            </li>
            <li>Save and enable the rule</li>
            <li>Click the test button above</li>
        </ol>
    </div>

    <script>
        function displayResult(elementId, data, isError = false) {
            const element = document.getElementById(elementId);
            element.className = `result ${isError ? 'error' : 'success'}`;
            element.innerHTML = JSON.stringify(data, null, 2);
        }

        async function testJSONPlaceholder() {
            const resultElement = document.getElementById('result1');
            resultElement.innerHTML = 'Testing...';
            
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/posts/1');
                const data = await response.json();
                
                if (data.title === "MOCKED POST") {
                    displayResult('result1', {
                        status: '‚úÖ SUCCESS - Response was intercepted!',
                        data: data
                    });
                } else {
                    displayResult('result1', {
                        status: '‚ùå NOT INTERCEPTED - Got original response',
                        data: data,
                        note: 'Make sure your override rule is created and enabled'
                    }, true);
                }
            } catch (error) {
                displayResult('result1', {
                    status: '‚ùå ERROR',
                    error: error.message
                }, true);
            }
        }

        async function testCustomAPI() {
            const resultElement = document.getElementById('result2');
            resultElement.innerHTML = 'Testing...';
            
            try {
                const response = await fetch('https://api.example.com/users');
                const data = await response.json();
                
                if (data.message === "Mocked by Interzept") {
                    displayResult('result2', {
                        status: '‚úÖ SUCCESS - Custom API was intercepted!',
                        data: data
                    });
                } else {
                    displayResult('result2', {
                        status: '‚ùå NOT INTERCEPTED',
                        data: data,
                        note: 'Make sure your custom API override rule is created and enabled'
                    }, true);
                }
            } catch (error) {
                displayResult('result2', {
                    status: '‚ùå ERROR (Expected if no override rule)',
                    error: error.message,
                    note: 'This error is expected if the override rule is not set up'
                }, true);
            }
        }

        async function testErrorResponse() {
            const resultElement = document.getElementById('result3');
            resultElement.innerHTML = 'Testing...';
            
            try {
                const response = await fetch('https://api.example.com/error');
                const data = await response.json();
                
                if (data.message === "Resource was intercepted by Interzept") {
                    displayResult('result3', {
                        status: '‚úÖ SUCCESS - Error response was intercepted!',
                        httpStatus: response.status,
                        data: data
                    });
                } else {
                    displayResult('result3', {
                        status: '‚ùå NOT INTERCEPTED',
                        httpStatus: response.status,
                        data: data
                    }, true);
                }
            } catch (error) {
                displayResult('result3', {
                    status: '‚ùå ERROR (Expected if no override rule)',
                    error: error.message,
                    note: 'This error is expected if the override rule is not set up'
                }, true);
            }
        }
    </script>
</body>
</html>
